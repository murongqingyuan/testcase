<!--pages/workOrder/workOrderList/workOrderList.wxml-->

<view>
  <searchBox bind:search="search" bind:reset="reset" bind:add="bindShowDialog"></searchBox>

  <view class="{{showDialog?'selectShow':'selectHidden'}}">
    <view class="mask" bindtap="bindHideDialog"></view>
    <view class="itemBox">
      <button class="itemButton" hover-class="itemButton_hover" bindtap="addWorkOrder" data-type="PrjWorkOrder">项目任务</button>
      <button class="itemButton" hover-class="itemButton_hover" bindtap="addWorkOrder" data-type="DptWorkOrder">部门任务</button>
      <button class="itemButton" hover-class="itemButton_hover" bindtap="addWorkOrder" data-type="CorpWorkOrder">公司任务</button>
    </view>
  </view>
  <view class="app_navbar" style="top:158rpx">
    <block wx:for="{{navbarTitle}}" wx:key="index">
      <view class="app_navbar_item {{navbarActiveIndex === index ? 'app_navbar_item_active' : ''}}" data-navbar-index="{{index}}" catchtap="onNavBarTap">
        <text>{{item}}</text> </view>
    </block>
  </view>

  <view style="height:10rpx;">
    <!-- 防止margin-top 垂直方向塌陷，在第一个元素前增加空元素。 -->
  </view>
  <!-- 页脚 -->
  <view wx:if="{{navbarActiveIndex==0}}" class="app_pageItem">
    <view class="app_text">已加载 {{workOrderList_prj.length}}/{{totalCount[navbarActiveIndex]}} 条
    </view>
    <view class="app_text" bindtap="scrollTop">返回顶部</view>
  </view>
  <view wx:if="{{navbarActiveIndex==1}}" class="app_pageItem">
    <view class="app_text" bindtap="scrollTop">已加载 {{workOrderList_dpt.length}}/{{totalCount[navbarActiveIndex]}} 条
    </view>
    <view class="app_text" bindtap="scrollTop">返回顶部</view>
  </view>
  <view wx:if="{{navbarActiveIndex==2}}" class="app_pageItem">
    <view class="app_text">已加载 {{workOrderList_corp.length}}/{{totalCount[navbarActiveIndex]}} 条
    </view>
    <view class="app_text" bindtap="scrollTop">返回顶部</view>
  </view>


  <swiper current="{{navbarActiveIndex}}" bindanimationfinish="onBindAnimationFinish" style="height:{{windowHeight-290}}rpx;margin-top: 230rpx;">

    <swiper-item wx:for="{{navbarTitle}}" wx:key="index">

      <scroll-view scroll-y="{{true}}" style="height:100%" refresher-enabled="true" bindrefresherrefresh="bindRefresh" refresher-triggered="{{isRefresh}}" bindscrolltolower="bindLoadMore" lower-threshold="50" scroll-top='{{scrollTopNum[navbarActiveIndex]}}'
        bindscroll="scrolltoupper" scroll-with-animation="false">
        <loading position="center" wx:if="{{!inited}}"></loading>
        <loading position="bottom" wx:if="{{loadMore}}"></loading>
        <block wx:if="{{index==0}}">
          <workOrderCard wx:for="{{workOrderList_prj}}" wx:key="index" workOrderInfo="{{item}}" vIndex="index" cardType="PrjWorkOrder"></workOrderCard>
          <loading position="bottom" wx:if="{{loadMore}}"></loading>
        </block>

        <block wx:if="{{index==1}}">
          <workOrderCard wx:for="{{workOrderList_dpt}}" wx:key="index" workOrderInfo="{{item}}" vIndex="index" cardType="DptWorkOrder"></workOrderCard>
          <loading position="bottom" wx:if="{{loadMore}}"></loading>
        </block>

        <block wx:if="{{index==2}}">
          <workOrderCard wx:for="{{workOrderList_corp}}" wx:key="index" workOrderInfo="{{item}}" vIndex="index" cardType="CorpWorkOrder"></workOrderCard>
          <loading position="bottom" wx:if="{{loadMore}}"></loading>
        </block>

      </scroll-view>
    </swiper-item>
  </swiper>

</view>